#!/bin/bash
SKETCHYBAR_CONFIG="$HOME/.config/sketchybar"
CONFIG_DIR="$HOME/.config/sketchybar"

DISPLAY_NUMBER=2

# Function to get the display type of the secondary display
get_secondary_display_type() {
    system_profiler SPDisplaysDataType | awk '
    BEGIN { display_count = 0; in_display_block = 0 }
    {
        if ($1 == "") {
            in_display_block = 0
        }
        if ($1 != "" && $2 == "" && $3 == "") {
            in_display_block = 1
            display_count++
        }
        if (in_display_block && display_count == 2) {
            if ($0 ~ /Display Type:/) {
                match($0, /Display Type: [^\n]*/)
                if (RSTART > 0) {
                    print substr($0, RSTART + 14, RLENGTH - 14)
                } else {
                    print "Unknown"
                }
                exit
            }
        }
    }'
}

# Get the display type of the secondary display
SECONDARY_DISPLAY_TYPE=$(get_secondary_display_type)

echo "Secondary display is of type '$SECONDARY_DISPLAY_TYPE'."

# Check if the secondary display type is "Built-in"
if [[ $SECONDARY_DISPLAY_TYPE = "Built-in"* ]]; then
	echo "Display number $DISPLAY_NUMBER is of type 'Built-in'. Loading laptop configuration."
	source "$SKETCHYBAR_CONFIG/sketchybarrc-laptop"
else
	echo "Display number $DISPLAY_NUMBER is not of type 'Built-in'. Loading desktop configuration."
	source "$SKETCHYBAR_CONFIG/sketchybarrc-desktop"
fi